(()=>{"use strict";({8136:function(){var e=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(s,c){function r(e){try{i(n.next(e))}catch(e){c(e)}}function a(e){try{i(n.throw(e))}catch(e){c(e)}}function i(e){var t;e.done?s(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,a)}i((n=n.apply(e,t||[])).next())}))};const t=chrome.runtime.getManifest().host_permissions||[];function o(t){return e(this,void 0,void 0,(function*(){if(t.url&&t.url.startsWith("http")&&t.id){const e=t.id,o=new URL(t.url).hostname;chrome.storage.local.get({defaultOnList:[]},(t=>{const n=!(-1===t.defaultOnList.indexOf(o));chrome.scripting.executeScript({target:{tabId:e,allFrames:!0},func:(e,t)=>(globalThis.topFrameDomain=e,globalThis.defaultOn=t,!!globalThis.isInjected),args:[o,n]}).then((t=>{if(t){const o=t.filter((e=>!e.result)).map((e=>e.frameId));o.length>0&&chrome.scripting.executeScript({target:{tabId:e,frameIds:o},files:["js/content_script.js"]}).catch((e=>{console.log(e)}))}})).catch((e=>{console.log(`(${o})`+e)}))}))}}))}chrome.runtime.onInstalled.addListener((e=>{if(e.reason===chrome.runtime.OnInstalledReason.INSTALL){const e=["www.youtube.com","vimeo.com","abema.tv","www.nicovideo.jp","video.fc2.com","www.twitch.tv","www.bilibili.com","v.qq.com","www.iqiyi.com","v.youku.com"];chrome.storage.local.set({defaultOnList:e}),chrome.storage.local.set({selectedPassSet:"p2"})}if(e.reason===chrome.runtime.OnInstalledReason.INSTALL||e.reason===chrome.runtime.OnInstalledReason.UPDATE){const e=chrome.i18n.getMessage("support_page");chrome.tabs.create({url:e}),chrome.tabs.query({status:"complete",url:t}).then((e=>{e.map((e=>{o(e)}))})).catch((e=>{console.log(e)}))}})),chrome.tabs.onUpdated.addListener(((e,t,n)=>{"complete"===t.status&&o(n)})),chrome.runtime.onMessage.addListener(((e,t,o)=>{"changeIconToOn"===e.op?t.tab&&chrome.action.setIcon({path:"../icons/on/icon48.png",tabId:t.tab.id}):"changeIconToOff"===e.op?t.tab&&chrome.action.setIcon({path:"../icons/off/icon48.png",tabId:t.tab.id}):"configureShortcuts"===e.op&&chrome.tabs.create({url:"chrome://extensions/shortcuts"})})),chrome.commands.onCommand.addListener((e=>{switch(e){case"01-animeSrOn":chrome.tabs.query({active:!0,currentWindow:!0,url:t},(e=>{if(e.length>0){const t=e[0],o=t.url;if(!o||!o.startsWith("http"))return;t.id&&chrome.tabs.sendMessage(t.id,{op:"startVideoProcessor"}).catch((e=>{console.log(e)}))}}));break;case"02-animeSrOff":chrome.tabs.query({active:!0,currentWindow:!0,url:t},(e=>{if(e.length>0){const t=e[0],o=t.url;if(!o||!o.startsWith("http"))return;t.id&&chrome.tabs.sendMessage(t.id,{op:"stopVideoProcessor"}).catch((e=>{console.log(e)}))}}));break;case"03-triggleFpsWindow":chrome.storage.local.get({showFpsWindow:!1},(e=>{chrome.storage.local.set({showFpsWindow:!e.showFpsWindow})}))}}))}})[8136]()})();