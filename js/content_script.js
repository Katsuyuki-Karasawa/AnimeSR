(()=>{var t={3466:function(t){var e;t.exports=((e=function(){function t(t){return n.appendChild(t.dom),t}function s(t){for(var e=0;e<n.children.length;e++)n.children[e].style.display=e===t?"block":"none";o=t}var o=0,n=document.createElement("div");n.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",n.addEventListener("click",(function(t){t.preventDefault(),s(++o%n.children.length)}),!1);var r=(performance||Date).now(),i=r,_=0,a=t(new e.Panel("FPS","#0ff","#002")),u=t(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var d=t(new e.Panel("MB","#f08","#201"));return s(0),{REVISION:16,dom:n,addPanel:t,showPanel:s,begin:function(){r=(performance||Date).now()},end:function(){_++;var t=(performance||Date).now();if(u.update(t-r,200),t>i+1e3&&(a.update(1e3*_/(t-i),100),i=t,_=0,d)){var e=performance.memory;d.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){r=this.end()},domElement:n,setMode:s}}).Panel=function(t,e,s){var o=1/0,n=0,r=Math.round,i=r(window.devicePixelRatio||1),_=80*i,a=48*i,u=3*i,d=2*i,l=3*i,c=15*i,x=74*i,f=30*i,m=document.createElement("canvas");m.width=_,m.height=a,m.style.cssText="width:80px;height:48px";var y=m.getContext("2d");return y.font="bold "+9*i+"px Helvetica,Arial,sans-serif",y.textBaseline="top",y.fillStyle=s,y.fillRect(0,0,_,a),y.fillStyle=e,y.fillText(t,u,d),y.fillRect(l,c,x,f),y.fillStyle=s,y.globalAlpha=.9,y.fillRect(l,c,x,f),{dom:m,update:function(a,h){o=Math.min(o,a),n=Math.max(n,a),y.fillStyle=s,y.globalAlpha=1,y.fillRect(0,0,_,c),y.fillStyle=e,y.fillText(r(a)+" "+t+" ("+r(o)+"-"+r(n)+")",u,d),y.drawImage(m,l+i,c,x-i,f,l,c,x-i,f),y.fillRect(l+x-i,c,i,f),y.fillStyle=s,y.globalAlpha=.9,y.fillRect(l+x-i,c,i,r((1-a/h)*f))}}},e)},8313:function(t,e,s){"use strict";var o=this&&this.__awaiter||function(t,e,s,o){return new(s||(s=Promise))((function(n,r){function i(t){try{a(o.next(t))}catch(t){r(t)}}function _(t){try{a(o.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(i,_)}a((o=o.apply(t,e||[])).next())}))},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=n(s(4774)),i=n(s(9897)),_=s(189);globalThis.isInjected=!0,globalThis.defaultOn&&_.VideoProcessor.startAll();const a=window.self===window.top,u=new Map([["Anime4kRestoreS",r.default],["Anime4kUpscaleS",i.default]]),d=[{name:"fast",passes:["Anime4kRestoreS"]},{name:"medium",passes:["Anime4kRestoreS","Anime4kUpscaleS"]},{name:"slow",passes:["Anime4kRestoreS","Anime4kUpscaleS","Anime4kRestoreS","Anime4kUpscaleS"]}];function l(t){const e=Number(t.slice(1))-1;if("p"===t[0]){const t=d[e].passes.map((t=>u.get(t)));_.VideoProcessor.setPassConstructors(t)}else chrome.storage.local.get("userDefinedPassSets",(t=>{const s=t.userDefinedPassSets[e].passes.map((t=>u.get(t)));_.VideoProcessor.setPassConstructors(s)}))}function c(){return o(this,void 0,void 0,(function*(){const t=new Set(document.getElementsByTagName("video"));for(const e of _.VideoProcessor.currentProcessorsMap.keys())t.has(e)||(_.VideoProcessor.removeVideoElement(e),_.VideoProcessor.hasDrmProtectedVideo||chrome.runtime.sendMessage({op:"noDrmProtectedVideoDetected"}));for(const e of t)_.VideoProcessor.currentProcessorsMap.has(e)||(_.VideoProcessor.addVideoElement(e),e.addEventListener("canplay",(()=>{e.mediaKeys&&(_.VideoProcessor.closeAll(),chrome.runtime.sendMessage({op:"drmProtectedVideoDetected"}))})),e.mediaKeys&&(_.VideoProcessor.closeAll(),chrome.runtime.sendMessage({op:"drmProtectedVideoDetected"})))}))}const x=new MutationObserver(c);function f(t){return o(this,void 0,void 0,(function*(){const e=globalThis.topFrameDomain;chrome.storage.local.get({defaultOnList:[]},(s=>{const o=s.defaultOnList,n=o.indexOf(e);t&&-1===n?(o.push(e),chrome.storage.local.set({defaultOnList:o})):t||-1===n||(o.splice(n,1),chrome.storage.local.set({defaultOnList:o}))}))}))}chrome.storage.local.get({selectedPassSet:"p2"},(t=>{l(t.selectedPassSet)})),x.observe(document.body,{subtree:!0,childList:!0}),c(),_.VideoProcessor.hasDrmProtectedVideo&&_.VideoProcessor.closeAll(),chrome.storage.onChanged.addListener((t=>o(void 0,void 0,void 0,(function*(){Object.keys(t).includes("selectedPassSet")&&l(t.selectedPassSet.newValue)})))),chrome.runtime.onMessage.addListener(((t,e,s)=>{switch(t.op){case"startVideoProcessor":_.VideoProcessor.hasDrmProtectedVideo?(_.VideoProcessor.closeAll(),chrome.runtime.sendMessage({op:"drmProtectedVideoDetected"})):(_.VideoProcessor.startAll(),a&&f(!0));break;case"stopVideoProcessor":_.VideoProcessor.closeAll(),a&&f(!1);break;case"getVideoProcessorState":s({videoProcessorIsOn:_.VideoProcessor.isOn});break;case"getDrmInfo":_.VideoProcessor.hasDrmProtectedVideo&&chrome.runtime.sendMessage({op:"drmProtectedVideoDetected"})}}))},4774:function(t,e,s){"use strict";var o,n,r,i,_,a=this&&this.__classPrivateFieldGet||function(t,e,s,o){if("a"===s&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?o:"a"===s?o.call(t):o?o.value:e.get(t)},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const d=u(s(7496)),l=s(9302);class c extends l.BasePass{constructor(t,e,s,u){super(t,e,s,u,1),o.set(this,"attribute vec2 a_position;\nvarying vec2 v_texture_position;\nvoid main() {\ngl_Position = vec4(a_position * 2.0 - 1.0, 0, 1);\nv_texture_position = a_position;\n}\n"),n.set(this,"precision mediump float;\nvarying vec2 v_texture_position;\nuniform sampler2D u_texture0;\nuniform vec2 u_size;\n\n#define go_0(x_off, y_off) (texture2D(u_texture0, vec2(x_off, y_off)))\nvoid main() {\nfloat t_x = v_texture_position.x;\nfloat t_y = v_texture_position.y;\nfloat d_x = 1.0 / u_size.x;\nfloat d_y = 1.0 / u_size.y;\n\nvec4 result = mat4(-0.19288683, -0.21397883, 0.111997396, -0.04791413, -0.26682988, -0.06144587, -0.03601853, -0.16693151, 0.038494494, -0.16651472, 0.147657, -0.083003886, 0.0, 0.0, 0.0, 0.0) * go_0(t_x - d_x, t_y - d_y);\nresult += mat4(-0.14286195, 0.08746566, -0.40107322, 0.12390977, -0.33392772, -0.18703035, -0.21326795, 0.04780781, -0.15155545, -0.0010025925, -0.1554875, -0.10676251, 0.0, 0.0, 0.0, 0.0) * go_0(t_x - d_x, t_y);\nresult += mat4(0.28095165, 0.022872915, -0.21342312, -0.29982176, 0.025937587, -0.055012174, -0.33779636, 0.0015666655, 0.076416336, 0.06656033, -0.1557806, 0.1078894, 0.0, 0.0, 0.0, 0.0) * go_0(t_x - d_x, t_y + d_y);\nresult += mat4(-0.31584853, 0.07527119, 0.30713862, -0.34014285, -0.50103146, -0.07217874, 0.512807, -0.09597398, -0.32097813, -0.051580857, -0.022466356, 0.01148551, 0.0, 0.0, 0.0, 0.0) * go_0(t_x, t_y - d_y);\nresult += mat4(-0.026032459, -0.04193211, 0.37703893, -0.031916667, -0.27421117, 1.0906446, -0.049654085, -0.19814016, 0.07819544, 0.06003738, 0.1405805, -0.0064135445, 0.0, 0.0, 0.0, 0.0) * go_0(t_x, t_y);\nresult += mat4(0.041450135, 0.11319654, -0.23237701, 0.08443178, 0.53344345, 0.30857387, -0.057264958, -0.1575803, 0.2325609, -0.027797326, -0.04544767, -0.18720597, 0.0, 0.0, 0.0, 0.0) * go_0(t_x, t_y + d_y);\nresult += mat4(0.2531829, -0.074966915, -0.27800754, -0.3146097, 0.20126024, -0.5380133, -0.15082566, -0.19021043, 0.29951036, 0.17123336, -0.01681872, -0.12574998, 0.0, 0.0, 0.0, 0.0) * go_0(t_x + d_x, t_y - d_y);\nresult += mat4(0.25203633, 0.19882993, 0.14906439, 0.13593598, 0.40712556, 0.084902965, 0.42969635, 0.2961132, -0.057267334, -0.030388135, 8.8084314e-05, 0.0210724, 0.0, 0.0, 0.0, 0.0) * go_0(t_x + d_x, t_y);\nresult += mat4(-0.13459359, -0.12199573, 0.12591946, 0.24736497, 0.2033463, -0.09388599, -0.094370656, 0.1071285, -0.18479438, -0.066625565, 0.08279283, 0.20130983, 0.0, 0.0, 0.0, 0.0) * go_0(t_x + d_x, t_y + d_y);\nresult += vec4(-0.011108127, -0.07481861, 0.07640154, 0.4964964);\n// gl_FragColor = texture2D(u_texture0, vec2(t_x, t_y));\ngl_FragColor = result;\n}\n"),r.set(this,"precision mediump float;\nvarying vec2 v_texture_position;\nuniform sampler2D u_texture0;\nuniform vec2 u_size;\n\n#define go_0(x_off, y_off) (max(texture2D(u_texture0, vec2(x_off, y_off)), 0.0))\n#define go_1(x_off, y_off) (max(-texture2D(u_texture0, vec2(x_off, y_off)), 0.0))\nvoid main() {\nfloat t_x = v_texture_position.x;\nfloat t_y = v_texture_position.y;\nfloat d_x = 1.0 / u_size.x;\nfloat d_y = 1.0 / u_size.y;\n\nvec4 result = mat4(-0.056432575, 0.0028165397, -0.026325442, -0.14802271, 0.16885762, -0.062179096, -0.2332292, 0.17513658, -0.08011296, 0.02947316, 0.014771492, -0.17946689, 0.026012989, -0.09823925, 0.036625937, -0.06924322) * go_0(t_x - d_x, t_y - d_y);\nresult += mat4(-0.13571467, 0.09831142, 0.12911566, 0.06305893, -0.07188695, -0.20161287, 0.3858435, -0.21069056, -0.12294444, -0.1404628, -0.022659872, 0.23008968, 0.10969853, 0.17640765, 0.39796907, 0.20413099) * go_0(t_x - d_x, t_y);\nresult += mat4(-0.0061665224, 0.055102807, -0.0059629944, -0.021429887, 0.061626043, 0.16898955, -0.21215646, 0.16510476, 0.2238265, 0.19429931, 0.09874656, 0.06828208, -0.122404456, -0.00026717107, -0.28203064, -0.29979932) * go_0(t_x - d_x, t_y + d_y);\nresult += mat4(-0.22735378, 0.14538136, 0.11549746, 0.194148, -0.09841722, -0.0661309, 0.348576, -0.017375294, -0.044078812, 0.1298332, 0.04793373, -0.30687734, 0.08353025, 0.083519086, 0.10766399, 0.31796935) * go_0(t_x, t_y - d_y);\nresult += mat4(0.048365135, -0.17566709, -0.33212858, -0.052667376, -0.26443407, -0.010216014, 0.1573303, 0.05725314, 0.08140953, -0.09664591, 0.076109104, -0.026773714, 0.07732627, 0.10188082, -0.28266954, -0.16230233) * go_0(t_x, t_y);\nresult += mat4(0.29931107, 0.117944, -0.10414009, 0.12795551, 0.12576093, 0.17082554, -0.15803693, 0.13430743, -0.025801308, -0.10797019, 0.0721032, 0.2825884, -0.11025257, 0.12798019, 0.081827976, -0.050441865) * go_0(t_x, t_y + d_y);\nresult += mat4(-0.11827391, 0.08306765, -0.3430314, 0.07898041, -0.023839617, -0.019507334, 0.23176382, -0.40992323, 0.09411734, 0.38415068, -0.25845516, -0.29984522, 0.1470966, -0.0684779, -0.07071314, -0.026773235) * go_0(t_x + d_x, t_y - d_y);\nresult += mat4(0.19091596, 0.082110435, -0.5266589, -0.1744098, -0.015838385, -0.046316292, 0.023171103, -0.03731331, 0.2642396, 0.31824252, -0.041754793, -0.09525519, -0.14696182, 0.052168854, 0.039857205, -0.027555354) * go_0(t_x + d_x, t_y);\nresult += mat4(0.15207373, 0.09845733, 0.0142631065, 0.096375965, 0.06089903, 0.17902578, -0.42391995, 0.22475442, 0.016356342, -0.06277531, -0.12173141, -0.18635495, -0.0013459618, 0.15725887, 0.019310836, 0.20293565) * go_0(t_x + d_x, t_y + d_y);\nresult += mat4(-0.18395247, 0.30672902, 0.09034339, 0.1821889, -0.0419004, -0.2169228, -0.14052129, 0.11006559, 0.1709272, 0.51062274, 0.13758625, -0.2242552, -0.030382963, 0.3357568, -0.26491287, 0.02501938) * go_1(t_x - d_x, t_y - d_y);\nresult += mat4(0.040511727, 0.12523083, -0.27318433, 0.08388512, 0.25354835, 0.3404216, -0.2632471, -0.17784123, 0.2732347, 0.4468553, 0.084667034, -0.1856242, 0.034099877, -0.00954992, -0.32751867, -0.062207516) * go_1(t_x - d_x, t_y);\nresult += mat4(0.17564747, 0.11645554, -0.16362113, 0.105654195, -0.2762563, -0.1413764, 0.23264363, -0.14000498, 0.095402054, 0.0715738, -0.19346157, -0.028285999, 0.009799127, 0.04059529, 0.19688335, 0.1282381) * go_1(t_x - d_x, t_y + d_y);\nresult += mat4(0.23575781, -0.11446148, -0.20504695, 0.035568226, 0.36890212, -0.85968876, -0.18545328, 0.33796397, -0.30916876, -0.10445518, -0.3046253, 0.33271998, -0.06263589, -0.2160114, -0.16383372, -0.31173357) * go_1(t_x, t_y - d_y);\nresult += mat4(0.20469664, 0.4039374, -0.070057206, 0.030353077, 0.39843914, -0.15490077, -0.24476516, 0.38238233, -0.21809858, 0.23496576, -0.051794037, 0.033664484, -0.14411364, -0.2515329, 0.124655396, -0.05818785) * go_1(t_x, t_y);\nresult += mat4(-0.09065731, -0.16787091, 0.013269188, 0.23687351, -0.41504318, -0.048163068, 0.31760025, -0.33648986, 0.29752317, 0.2926866, 0.14408836, -0.33382463, -0.15873958, -0.121961035, 0.11797893, 0.09000567) * go_1(t_x, t_y + d_y);\nresult += mat4(0.13356976, 0.013763947, 0.012169505, -0.109594524, 0.03417223, 0.7031121, 0.65146804, 0.5250268, -0.50132495, -0.419648, 0.2940041, 0.83051753, -0.17595838, 0.1633008, -0.018587278, 0.079596795) * go_1(t_x + d_x, t_y - d_y);\nresult += mat4(0.07570128, -0.1581438, 0.03904949, 0.14890033, -0.054611947, 0.17469402, -0.44252598, 0.036181703, -0.4981031, -0.37507218, -0.18466389, 0.2645845, 0.25189674, -0.025896115, 0.034307647, -0.020462232) * go_1(t_x + d_x, t_y);\nresult += mat4(-0.11645865, 0.02296537, 0.040909223, 0.015069485, 0.062284566, -0.22526766, 0.09241534, -0.32623053, 0.18208642, 0.3954284, 0.2884468, -0.25137675, -0.037232924, -0.10185309, -0.17956531, 0.018966453) * go_1(t_x + d_x, t_y + d_y);\nresult += vec4(-0.16371979, -0.024620198, -0.035754893, 0.04176776);\ngl_FragColor = result;\n}\n"),i.set(this,"precision mediump float;\nvarying vec2 v_texture_position;\nuniform sampler2D u_texture0;\nuniform vec2 u_size;\n\n#define go_0(x_off, y_off) (max(texture2D(u_texture0, vec2(x_off, y_off)), 0.0))\n#define go_1(x_off, y_off) (max(-texture2D(u_texture0, vec2(x_off, y_off)), 0.0))\nvoid main() {\nfloat t_x = v_texture_position.x;\nfloat t_y = v_texture_position.y;\nfloat d_x = 1.0 / u_size.x;\nfloat d_y = 1.0 / u_size.y;\n\nvec4 result = mat4(0.01921286, -0.26684764, -0.12663573, 0.31641877, -0.25313398, 0.12264074, 0.58750325, -0.14084283, 0.5837018, -0.042300556, -0.20435576, -0.009954825, 0.060783498, 0.05540401, 0.2205112, -0.06578902) * go_0(t_x - d_x, t_y - d_y);\nresult += mat4(-0.21930243, -0.03774968, 0.22615197, 0.18338196, 0.011201461, -0.271034, 0.00573116, -0.12248194, 0.47990513, 0.2982416, -0.1087603, -0.050099242, -0.07620939, -0.07148229, 0.03691984, -0.16796488) * go_0(t_x - d_x, t_y);\nresult += mat4(-0.14962853, -0.053769328, 0.02387081, 0.22002189, 0.052237745, -0.26160842, -0.08603077, 0.012542448, 0.08119985, 0.075785555, -0.33437458, -0.43373227, -0.13206963, -0.08759176, -0.03288923, -0.09799959) * go_0(t_x - d_x, t_y + d_y);\nresult += mat4(-0.1305593, -0.5974288, 0.06058367, 0.08406488, 0.013692483, 0.06646377, 0.16469325, 0.08990975, 0.42217395, -0.11289523, -0.06165009, 0.48556912, -0.15702641, -0.19922857, -0.0035429662, -0.0022089656) * go_0(t_x, t_y - d_y);\nresult += mat4(-0.1964807, 0.038099788, 0.21587034, 0.039734077, -0.07063389, 0.11604167, -0.24558097, -0.08900199, -0.7684516, -0.1037487, -0.09380674, 0.33144563, -0.16653742, 0.0028585843, -0.33774406, -0.0528696) * go_0(t_x, t_y);\nresult += mat4(-0.27298656, -0.05665099, 0.09661685, 0.19780266, 0.1025106, -0.22055034, -0.21218458, -0.040628925, 0.0095010325, 0.13118382, -0.42582452, -0.22197723, 0.21006055, -0.06189587, -0.15285942, -0.09526762) * go_0(t_x, t_y + d_y);\nresult += mat4(-0.14494462, -0.046788953, 0.065877035, 0.09911713, 0.35096622, 0.16682479, 0.028363144, 0.36037162, 0.29413632, 0.28212717, -0.025364442, -0.3406269, 0.047262143, -0.11892685, -0.008032766, 0.29743317) * go_0(t_x + d_x, t_y - d_y);\nresult += mat4(-0.15191558, -0.36980554, 0.14555687, 0.0043930537, -0.012661432, 0.15737776, -0.115250416, 0.10324491, 0.24491951, -0.15575431, -0.27802598, 0.21959937, 0.18063772, 0.4455559, -0.09693302, 0.33382267) * go_0(t_x + d_x, t_y);\nresult += mat4(0.2717801, 0.13452889, 0.14105384, 0.16324317, -0.40111846, 0.1154301, -0.0076733204, -0.09697362, 0.44306824, -0.02831414, -0.2153124, -0.12075326, 0.060776163, 0.30347148, -0.0036976219, -0.12070682) * go_0(t_x + d_x, d_y + t_y);\nresult += mat4(-0.39780128, -0.29875937, -0.12952097, 0.080333896, 0.07520163, 0.021689568, -0.23121156, -0.038140096, -0.1593877, 0.017156163, -0.06038025, 0.009244022, -0.13917233, 0.30957314, 0.243109, -0.104947075) * go_1(t_x - d_x, t_y - d_y);\nresult += mat4(-0.07965157, 0.06776501, -0.13288979, 0.005851189, -0.08768168, -0.03689969, 0.12034646, 0.22441491, 0.14453568, -0.17648841, -0.3378289, -0.018329712, 0.11722939, -0.34161824, 0.08424494, -0.01400687) * go_1(t_x - d_x, t_y);\nresult += mat4(0.08153887, 0.07222914, -0.14663404, -0.038526025, -0.07385973, 0.18440577, 0.35890242, 0.17084727, 0.26345527, 0.15280858, -0.007446105, -0.024403179, -0.30336383, -0.22978698, 0.11612946, -0.23614909) * go_1(t_x - d_x, t_y + d_y);\nresult += mat4(-0.07447396, 0.09023449, -0.13798, -0.086943336, -0.30787337, 0.15087669, 0.14418626, -0.03371195, 0.048989657, -0.13075387, -0.13458036, -0.059836224, 0.06495196, 0.269715, 0.3674355, 0.38956037) * go_1(t_x, t_y - d_y);\nresult += mat4(0.34981915, -0.048779126, 0.31717536, 0.38080826, -0.20149232, -0.82969636, -0.10167862, 0.6382858, 0.25976858, 0.4370118, -0.04724865, -0.10014156, 0.19380626, -0.080370255, 0.09578106, -0.035166856) * go_1(t_x, t_y);\nresult += mat4(-0.026443917, 0.4132611, 0.01822534, 0.12742202, -0.26652107, -0.2996705, 0.30905882, 0.07989903, 0.38249823, 0.21486135, 0.025314959, -0.14717339, -0.13344015, -0.32088286, -0.2833883, -0.30973712) * go_1(t_x, t_y + d_y);\nresult += mat4(0.021517841, 0.006556378, 0.2025686, -0.12044382, -0.38583103, -0.0027515136, -0.06556736, -0.097090125, 0.04676486, -0.11954886, -0.051612873, 0.07831412, -0.18823163, -0.16542958, 0.04245155, 0.6437998) * go_1(t_x + d_x, t_y - d_y);\nresult += mat4(-0.39475346, -0.2936861, 0.26768062, -0.28151843, 0.21935691, 0.2101108, -0.15455097, 0.19548604, 0.09188909, -0.020147726, 0.103328265, -0.12574542, -0.34167948, 0.07523185, -0.17669058, 0.62446547) * go_1(t_x + d_x, t_y);\nresult += mat4(-0.37661025, -0.29630858, 0.05451026, 0.1611643, 0.14079669, -0.2170294, -0.038716137, 0.13514164, -0.21235192, -0.07860726, -0.005749412, 0.025625167, -0.13297133, 0.33012658, -0.27434957, -0.18416783) * go_1(t_x + d_x, t_y + d_y);\nresult += vec4(-0.0036821906, -0.050239526, -0.01355402, 0.00048220603);\ngl_FragColor = result;\n}\n"),_.set(this,"precision mediump float;\nvarying vec2 v_texture_position;\nuniform sampler2D u_texture0;\nuniform sampler2D u_texture1;\nuniform vec2 u_size;\n\n#define go_0(x_off, y_off) (max(texture2D(u_texture1, vec2(x_off, y_off)), 0.0))\n#define go_1(x_off, y_off) (max(-texture2D(u_texture1, vec2(x_off, y_off)), 0.0))\nvoid main() {\nfloat t_x = v_texture_position.x;\nfloat t_y = v_texture_position.y;\nfloat d_x = 1.0 / u_size.x;\nfloat d_y = 1.0 / u_size.y;\n\nvec4 result = mat4(0.15873, 0.17989138, 0.14648493, 0.0, -0.017379675, -0.017363746, -0.019855022, 0.0, 0.009670625, 0.0070157526, 0.0075994316, 0.0, 0.025388412, 0.027231036, 0.024052646, 0.0) * go_0(t_x - d_x, t_y - d_y);\nresult += mat4(0.048195973, 0.041760173, 0.037366055, 0.0, -0.115950756, -0.12887983, -0.12535639, 0.0, 0.032125086, 0.03397254, 0.032950625, 0.0, 0.01223746, 0.020822672, 0.0161561, 0.0) * go_0(t_x - d_x, t_y);\nresult += mat4(0.0890567, 0.094453335, 0.09014035, 0.0, 0.016081346, 0.017434116, 0.020783134, 0.0, -0.011775135, -0.010094134, -0.018522855, 0.0, 0.072103254, 0.07940666, 0.065876864, 0.0) * go_0(t_x - d_x, t_y + d_y);\nresult += mat4(-0.04841196, -0.06963968, -0.056574684, 0.0, 0.10912542, 0.11813441, 0.10643838, 0.0, -0.013013885, -0.01562045, -0.013802797, 0.0, 0.037505716, 0.04352026, 0.04645123, 0.0) * go_0(t_x, t_y - d_y);\nresult += mat4(-0.3472869, -0.36243078, -0.33530185, 0.0, 0.23654196, 0.2305048, 0.22150646, 0.0, -0.045226905, -0.041799217, -0.042511635, 0.0, -0.10267792, -0.1123385, -0.10845448, 0.0) * go_0(t_x, t_y);\nresult += mat4(0.011987401, 0.012285043, 0.007813165, 0.0, -0.15911353, -0.17523928, -0.1535267, 0.0, 0.15675929, 0.16531634, 0.15948962, 0.0, -0.09240023, -0.09513292, -0.084187366, 0.0) * go_0(t_x, t_y + d_y);\nresult += mat4(0.069052905, 0.07278333, 0.0756627, 0.0, -0.012180326, -0.018794727, -0.031050753, 0.0, -0.044663202, -0.04362803, -0.038904265, 0.0, -0.008540197, -0.011201734, -0.01556625, 0.0) * go_0(t_x + d_x, t_y - d_y);\nresult += mat4(-0.08261173, -0.09042543, -0.07589266, 0.0, 0.043515377, 0.045066774, 0.04037769, 0.0, -0.06262993, -0.07469342, -0.058593787, 0.0, 0.026696987, 0.028740842, 0.037405368, 0.0) * go_0(t_x + d_x, t_y);\nresult += mat4(0.07975598, 0.09597654, 0.08997132, 0.0, -0.07844719, -0.07880916, -0.06835411, 0.0, 0.05668995, 0.050163813, 0.053357534, 0.0, -0.020040333, -0.019867316, -0.01907621, 0.0) * go_0(t_x + d_x, d_y + t_y);\nresult += mat4(-0.017078733, -0.017393313, -0.008266595, 0.0, -0.0033478448, -0.0027439648, -0.0042334674, 0.0, -0.06354017, -0.062058125, -0.04652064, 0.0, -0.010787706, -0.0062706997, -0.007573461, 0.0) * go_1(t_x - d_x, t_y - d_y);\nresult += mat4(-0.019895451, -0.016341688, -0.008712399, 0.0, 0.026231976, 0.023955572, 0.0216376, 0.0, -0.061950512, -0.05481285, -0.05261985, 0.0, -0.018804235, -0.016235247, -0.0131616965, 0.0) * go_1(t_x - d_x, t_y);\nresult += mat4(-0.055628926, -0.063315354, -0.057192408, 0.0, -0.0256364, -0.028660972, -0.02937357, 0.0, -0.017604912, -0.020851422, -0.016070362, 0.0, -0.0870202, -0.0832279, -0.07525406, 0.0) * go_1(t_x - d_x, t_y + d_y);\nresult += mat4(0.062738225, 0.07106593, 0.061644047, 0.0, -0.06068257, -0.06983662, -0.066070385, 0.0, 0.024919355, 0.03227179, 0.028569462, 0.0, -0.07866227, -0.098967604, -0.092128105, 0.0) * go_1(t_x, t_y - d_y);\nresult += mat4(0.040397774, 0.047241107, 0.03962998, 0.0, -0.09112752, -0.10057507, -0.09301817, 0.0, 0.10833967, 0.101835825, 0.10027467, 0.0, 0.27189335, 0.27433604, 0.26781923, 0.0) * go_1(t_x, t_y);\nresult += mat4(-0.044211388, -0.042373534, -0.03658007, 0.0, 0.113148406, 0.12423258, 0.107804194, 0.0, -0.17081551, -0.18562958, -0.17475435, 0.0, 0.09636739, 0.10763415, 0.093332425, 0.0) * go_1(t_x, t_y + d_y);\nresult += mat4(-0.03798545, -0.047811143, -0.050768293, 0.0, 0.018775463, 0.026812987, 0.03452908, 0.0, 0.0055677597, 0.0039081173, -0.0017878668, 0.0, -0.10728597, -0.12618187, -0.109045394, 0.0) * go_1(t_x + d_x, t_y - d_y);\nresult += mat4(0.06359783, 0.064184755, 0.04934199, 0.0, -0.009819327, -0.006616115, -0.007431496, 0.0, 0.025055679, 0.024787048, 0.017360551, 0.0, -0.047140837, -0.061695747, -0.06440822, 0.0) * go_1(t_x + d_x, t_y);\nresult += mat4(0.060199022, 0.06482763, 0.059514645, 0.0, 0.026998974, 0.028776823, 0.024897143, 0.0, 0.17968474, 0.19337215, 0.16760105, 0.0, 0.0075838566, 0.010503482, 0.011993149, 0.0) * go_1(t_x + d_x, d_y + t_y);\nresult += vec4(-0.0052927984, -0.0060193934, -0.0048643993, 0.0);\ngl_FragColor = result + texture2D(u_texture0, (vec2(t_x, t_y)));\n}\n");const l=new d.default(t,[this.inputTexture],a(this,o,"f"),a(this,n,"f"),s,u),c=new d.default(t,[l.outputTexture],a(this,o,"f"),a(this,r,"f"),s,u),x=new d.default(t,[c.outputTexture],a(this,o,"f"),a(this,i,"f"),s,u),f=new d.default(t,[this.inputTexture,x.outputTexture],a(this,o,"f"),a(this,_,"f"),s,u);this.outputTexture=f.outputTexture,this.programs=[l,c,x,f]}}e.default=c,o=new WeakMap,n=new WeakMap,r=new WeakMap,i=new WeakMap,_=new WeakMap},9897:function(t,e,s){"use strict";var o,n,r,i,_,a,u=this&&this.__classPrivateFieldGet||function(t,e,s,o){if("a"===s&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?o:"a"===s?o.call(t):o?o.value:e.get(t)},d=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const l=d(s(7496)),c=s(9302);class x extends c.BasePass{constructor(t,e,s,d){super(t,e,s,d,2),o.set(this,"attribute vec2 a_position;\nvarying vec2 v_texture_position;\nvoid main() {\ngl_Position = vec4(a_position * 2.0 - 1.0, 0, 1);\nv_texture_position = a_position;\n}\n"),n.set(this,"precision mediump float;\nvarying vec2 v_texture_position;\nuniform sampler2D u_texture;\nuniform vec2 u_size;\n\n#define go_0(x_off, y_off) (texture2D(u_texture, vec2(x_off, y_off)))\nvoid main() {\nfloat t_x = v_texture_position.x;\nfloat t_y = v_texture_position.y;\nfloat d_x = 1.0 / u_size.x;\nfloat d_y = 1.0 / u_size.y;\n\nvec4 result = mat4(-0.0057322932, 0.12928207, -0.056848746, 0.18680117, -0.0306273, 0.25602463, 0.053723164, 0.20419341, 0.0018709862, 0.022848232, -0.04105527, 0.10169034, 0.0, 0.0, 0.0, 0.0) * go_0(t_x - d_x, t_y - d_y);\nresult += mat4(0.009471417, -0.12957802, 0.096014425, 0.21836184, 0.00021601951, -0.22997683, 0.23666254, 0.41192335, 0.021762101, 0.0047863554, 0.008233427, 0.108514786, 0.0, 0.0, 0.0, 0.0) * go_0(t_x - d_x, t_y);\nresult += mat4(-0.01156376, -0.18988979, 0.04614705, -0.044767227, 0.01050636, -0.26426336, 0.23741047, 0.0027636609, -0.027718676, -0.14202335, -0.016650287, -0.06637125, 0.0, 0.0, 0.0, 0.0) * go_0(t_x - d_x, t_y + d_y);\nresult += mat4(0.057809234, -0.11033858, 0.056533534, -0.06292466, 0.13880666, -0.18710336, 0.2441031, -0.25326246, 0.0032683122, -0.026437074, 0.0023248852, 7.640766e-05, 0.0, 0.0, 0.0, 0.0) * go_0(t_x, t_y - d_y);\nresult += mat4(-0.49110603, 0.4429004, -0.44015464, -0.41174838, -0.87738293, 0.7808468, -1.0929365, -0.59699076, -0.18409836, 0.185138, -0.11773224, -0.17097276, 0.0, 0.0, 0.0, 0.0) * go_0(t_x, t_y);\nresult += mat4(0.10580959, -0.055947904, -0.03431237, -0.080236495, 0.14862584, -0.15393938, -0.18872876, -0.3170681, 0.03559387, -0.003990826, 0.021298569, 0.012844483, 0.0, 0.0, 0.0, 0.0) * go_0(t_x, t_y + d_y);\nresult += mat4(-0.040715586, -0.25781113, 0.08896714, -0.1225879, -0.15790503, -0.54010904, 0.29588607, 0.10401059, 0.003413123, -0.108357325, 0.0112870345, -0.11888622, 0.0, 0.0, 0.0, 0.0) * go_0(t_x + d_x, t_y - d_y);\nresult += mat4(0.0049315444, 0.02376202, -0.08224771, 0.121118225, -0.041512914, -0.027994309, -0.585988, -0.069672115, -0.017247835, 0.0056576864, 0.04319012, 0.055003505, 0.0, 0.0, 0.0, 0.0) * go_0(t_x + d_x, t_y);\nresult += mat4(0.37521392, 0.15916082, 0.059708964, 0.19046007, 0.8120325, 0.38343868, 0.3436578, 0.5287958, 0.16570656, 0.06957687, 0.014022592, 0.074799836, 0.0, 0.0, 0.0, 0.0) * go_0(t_x + d_x, t_y + d_y);\nresult += vec4(-0.01050964, -0.00939481, 0.17684458, 0.027366742);\ngl_FragColor = result;\n}\n"),r.set(this,"precision mediump float;\nvarying vec2 v_texture_position;\nuniform sampler2D u_texture;\nuniform vec2 u_size;\n\n#define go_0(x_off, y_off) (max(texture2D(u_texture, vec2(x_off, y_off)), 0.0))\n#define go_1(x_off, y_off) (max(-texture2D(u_texture, vec2(x_off, y_off)), 0.0))\nvoid main() {\nfloat t_x = v_texture_position.x;\nfloat t_y = v_texture_position.y;\nfloat d_x = 1.0 / u_size.x;\nfloat d_y = 1.0 / u_size.y;\n\nvec4 result = mat4(-0.011029496, 0.05866063, -0.09460646, -0.017664742, -0.022488879, 0.18384217, -0.00397663, -0.064733066, 0.08466802, 0.10667488, 8.0212536e-05, 0.0908869, 0.13580276, 0.00097438256, 0.12176522, -0.08218466) * go_0(t_x - d_x, t_y - d_y);\nresult += mat4(0.16062798, -0.10190268, 0.03280682, 0.05621916, -0.009684231, -0.08464307, 0.17058301, -0.096469186, 0.1967505, -0.1450099, 0.093607284, -0.28240147, -0.21377413, 0.10079291, -0.1741522, 0.17330575) * go_0(t_x - d_x, t_y);\nresult += mat4(-0.060160473, 0.06316997, 0.0046929033, -0.049405966, 0.13851729, 0.06830702, -0.0586872, -0.040827133, 0.007052838, -0.03576886, -0.111261636, 0.039155316, -0.07380389, -0.09369825, 0.04471156, 0.09678487) * go_0(t_x - d_x, t_y + d_y);\nresult += mat4(-0.36683616, -0.035950605, -0.24414362, -0.009159744, 0.19335322, -0.099253505, 0.075083904, -0.00076695543, 0.65291303, -0.25599423, 0.19827642, 0.065899536, -0.07423247, -0.068967685, 0.0050554527, -0.060272824) * go_0(t_x, t_y - d_y);\nresult += mat4(-0.020688485, -0.83178276, 0.11104878, 0.26454413, 0.13655476, 0.37675047, -0.22219229, -0.01751935, 0.44552696, 0.92510307, 0.16063261, -0.62011045, 0.19366647, -0.06996067, -0.2504841, 0.00803723) * go_0(t_x, t_y);\nresult += mat4(0.0051537007, -0.057168536, -0.16110587, 0.25232598, -0.04447099, 0.11997351, 0.14808103, -0.34443566, -0.26212573, -0.21970181, 0.2724405, 0.21050811, -0.07949061, -0.064808235, -0.21208277, -0.0042361654) * go_0(t_x, t_y + d_y);\nresult += mat4(-0.0888952, -0.20169449, 0.19144905, -0.016882861, -0.013283103, 0.07552998, -0.24686803, 0.012453213, -0.065454446, -0.016123284, -0.47316182, 0.070926026, 0.09219782, 0.13118166, 0.074736096, 0.0077910526) * go_0(t_x + d_x, t_y - d_y);\nresult += mat4(0.5832154, 0.1138069, -0.039765622, 0.3182784, -0.25497997, 0.0013993139, 0.39285088, -0.48511526, -0.39891505, -0.19094779, -0.082146175, -0.20826934, 0.020590555, -0.0012490178, -0.4398621, 0.14377014) * go_0(t_x + d_x, t_y);\nresult += mat4(0.21917395, 3.4314657e-05, 0.25734863, -0.3433305, 0.015720673, 0.2676127, -0.06807297, 0.15040149, -0.23638041, -0.0050233034, -0.13666134, 0.4542111, -0.033572577, -0.08450588, -0.23341487, 0.053490847) * go_0(t_x + d_x, t_y + d_y);\nresult += mat4(-0.17482175, 0.057647135, 0.33135444, 0.0850751, -0.1718849, -0.0854123, 0.036795795, -0.13874969, -0.10903869, -0.19007301, -0.06064334, -0.03786032, -0.036696054, 0.07844446, 0.012523185, -0.01562906) * go_1(t_x - d_x, t_y - d_y);\nresult += mat4(-0.04411997, -0.10331819, 0.10050193, 0.12406485, 0.07431592, 0.30109692, -0.17511666, -0.13263564, -0.10192587, 0.07821255, -0.22415096, 0.25552443, 0.17881326, -0.13914281, 0.109979235, -0.0016463579) * go_1(t_x - d_x, t_y);\nresult += mat4(-0.01911644, -0.15412527, 0.028903123, 0.20831817, 0.00375175, 0.08110953, 0.074919395, -0.17581624, -0.015677985, 0.06504228, 0.08817818, -0.12518327, -0.09537373, 0.028905088, -0.051288474, 0.054334078) * go_1(t_x - d_x, t_y + d_y);\nresult += mat4(0.2852779, -0.28924024, 0.36805123, 0.21079305, -0.28336474, 0.1679663, -0.08641141, -0.10699407, -0.16090055, 0.1287612, -0.15910125, 0.05734755, 0.15883245, 0.0053026294, 0.080674745, 0.0505137) * go_1(t_x, t_y - d_y);\nresult += mat4(0.17639062, 0.3790122, -0.19588692, -0.020314282, 0.26197383, 0.09014768, 0.19696823, -0.41025418, -0.08308115, -0.33279485, -0.22528782, 0.06172439, -0.1365661, -0.13094363, -0.005086559, 0.089024484) * go_1(t_x, t_y);\nresult += mat4(0.05262993, 0.0006296959, 0.1657725, -0.32591924, 0.12126701, 0.061543245, -0.10526848, 0.041583937, 0.094976954, 0.09416157, -0.22019257, -0.058390073, -0.2073888, 0.057273377, 0.19558284, 0.004208022) * go_1(t_x, t_y + d_y);\nresult += mat4(0.30005738, 0.18478931, -0.23342943, 0.22455733, -0.016488122, 0.099634305, 0.31620836, -0.15731157, 0.09595808, 0.0013774688, 0.48273298, -0.07027936, -0.18764344, -0.26194447, -0.11794225, -0.012173601) * go_1(t_x + d_x, t_y - d_y);\nresult += mat4(0.117986746, -0.13846518, -0.019614812, -0.3011192, 0.5501164, 0.3408611, -0.40090847, 0.15706886, 0.13050972, 0.051776595, 0.20792943, 0.23389706, -0.22965533, -0.053367328, 0.3911586, -0.032988597) * go_1(t_x + d_x, t_y);\nresult += mat4(0.054753624, -0.008485731, -0.2451672, 0.17528129, 0.13657846, 0.010480436, 0.07651423, -0.43316832, 0.12736236, 0.13804524, 0.12529011, -0.30946237, -0.14423579, 0.08403089, 0.24335162, 0.057288036) * go_1(t_x + d_x, t_y + d_y);\nresult += vec4(0.012077211, 0.013045883, 0.0380778, -0.02908858);\ngl_FragColor = result;\n}\n"),i.set(this,"precision mediump float;\nvarying vec2 v_texture_position;\nuniform sampler2D u_texture;\nuniform vec2 u_size;\n\n#define go_0(x_off, y_off) (max(texture2D(u_texture, vec2(x_off, y_off)), 0.0))\n#define go_1(x_off, y_off) (max(-texture2D(u_texture, vec2(x_off, y_off)), 0.0))\nvoid main() {\nfloat t_x = v_texture_position.x;\nfloat t_y = v_texture_position.y;\nfloat d_x = 1.0 / u_size.x;\nfloat d_y = 1.0 / u_size.y;\n\nvec4 result = mat4(-0.036115196, -0.06971895, -0.07508942, 0.016036168, 0.12120111, 0.24536026, 0.044755507, -0.20663576, 0.029635755, -0.15427187, 0.027148994, -0.20795093, 0.10170582, 0.077919215, 0.66063017, -0.4632968) * go_0(t_x - d_x, t_y - d_y);\nresult += mat4(-0.0052889925, -0.019060908, -0.08660142, -0.022095207, -0.08097976, -0.015142803, -0.18552722, -0.078493506, -0.16293915, -0.20099808, -0.08370822, 0.3701389, 0.09094984, 0.2487225, 0.24338846, 0.044003833) * go_0(t_x - d_x, t_y);\nresult += mat4(-0.061406493, -0.017232792, -0.10917424, 0.11203319, 0.040699825, -0.019294346, 0.084953666, -0.018133596, 0.07209552, 0.016069936, 0.17805555, -0.089537814, 0.15809004, 0.1027023, 0.15044671, -0.15530108) * go_0(t_x - d_x, t_y + d_y);\nresult += mat4(0.0948676, -0.040305693, -0.005591629, -0.048048403, -0.07547777, 0.056606572, 0.021390207, 0.32600567, -0.20805131, -0.099587254, 0.029613169, 0.0092129605, -0.29429698, -0.09898621, 0.44470885, -0.89487344) * go_0(t_x, t_y - d_y);\nresult += mat4(-0.122259885, 0.11445877, 0.06666907, 0.1869428, -0.1553992, -0.1658741, 0.2988138, -0.57746625, -0.34609964, 0.11169158, -0.41877756, 0.38075635, 0.21293911, 0.09640372, -0.12754214, -0.08026104) * go_0(t_x, t_y);\nresult += mat4(0.15128808, 0.050087795, 0.09219755, -0.18080945, 0.0044571217, -0.046019405, -0.1289922, 0.20305426, 0.19601224, 0.04667917, 0.17465587, 0.027672665, 0.18441725, 0.06845396, 0.11288585, -0.23283863) * go_0(t_x, t_y + d_y);\nresult += mat4(-0.072962, -0.06639447, 0.049347494, -0.1386401, 0.10396071, 0.08187777, -0.04280746, 0.07390891, 0.06628344, 0.037797406, 0.021885803, -0.013147403, 0.22376558, 0.36243078, 0.12874891, -0.0023783944) * go_0(t_x + d_x, t_y - d_y);\nresult += mat4(0.074945286, 0.16045591, -0.11798349, 0.12910712, 0.054760084, -0.095626175, -0.047832094, 0.03493912, 0.11817307, 0.037452437, -0.14301221, -0.027356789, -0.052390423, 0.11373512, 0.07686775, 0.010008694) * go_0(t_x + d_x, t_y);\nresult += mat4(-0.023999173, -0.091900624, 0.02388157, 0.03173873, 0.0065633506, -0.033716757, -0.1198324, 0.12057766, 0.026465805, -0.07517131, -0.07760598, 0.060463097, 0.07345541, 0.046037503, 0.21101558, -0.26785463) * go_0(t_x + d_x, d_y + t_y);\nresult += mat4(0.15544604, -0.03902825, 0.04630384, -0.25173616, -0.0691359, 0.07476507, 0.009071253, 0.089964196, -0.26539803, -0.3958477, -0.22155671, 0.20735882, -0.105860494, -0.003996804, -0.044815883, 0.39544627) * go_1(t_x - d_x, t_y - d_y);\nresult += mat4(0.6169709, 0.23717614, -0.37884676, -0.7484867, 0.020169826, -0.30718836, 1.0965588, -0.20711036, -0.39149985, -0.06843563, -0.06522909, 0.103805855, 0.03265825, -0.15137726, 0.12837899, -0.01294922) * go_1(t_x - d_x, t_y);\nresult += mat4(-0.23638196, -0.4560866, -0.11948684, -0.1464144, 0.10690008, 0.007835961, 0.11864342, -0.13101323, -0.16509797, 0.075027354, 0.08122998, 0.13451207, 0.0011890623, 0.052157886, 0.08372405, -0.07085038) * go_1(t_x - d_x, t_y + d_y);\nresult += mat4(-0.21997726, -0.16488647, -0.0291317, 0.17997476, 0.1493211, 0.027494298, 0.0034613227, -0.3207727, 0.18699001, 0.14728633, -0.042895135, -0.07612043, 0.125076, -0.14714554, -0.03480009, -0.22753975) * go_1(t_x, t_y - d_y);\nresult += mat4(-0.5342686, -0.7426105, -0.38294584, 0.42549992, 0.46053204, 0.7867879, 0.106234804, -0.041163098, 0.5198579, -0.5219404, 0.14809476, -0.41802374, 0.06810794, -0.15122683, -0.047409, 0.13178343) * go_1(t_x, t_y);\nresult += mat4(-0.50428164, 0.18220626, 0.35510704, -0.081787474, 0.03155813, 0.019284263, 0.0032388573, -0.20513348, -0.05385551, 0.17803182, -0.26206362, 0.2870375, 0.008557827, 0.08401449, -0.027598893, -0.010791235) * go_1(t_x, t_y + d_y);\nresult += mat4(0.16657415, 0.067647465, 0.093076974, -0.14438486, -0.10017002, 0.0022367141, 0.03250936, -0.052794546, -0.009178676, -0.019673595, -0.0016697067, -0.15424626, -0.112123474, -0.11079971, 0.011987111, -0.11747758) * go_1(t_x + d_x, t_y - d_y);\nresult += mat4(-0.023021797, -0.058703423, -0.037978355, -0.062433913, -0.13130441, 0.048656322, 0.056839373, 0.109036915, -0.07823158, 0.14785293, 0.058555078, -0.11679035, -0.14002073, 0.07395252, 0.098268874, -0.06710464) * go_1(t_x + d_x, t_y);\nresult += mat4(0.14906375, 0.030001195, -0.10338215, 0.0662968, -0.161953, -0.13682815, 0.09563142, 0.009514228, -0.009491218, 0.06737101, -0.1393389, 0.15231515, -0.073147796, 0.00767062, 0.028675212, 0.014213088) * go_1(t_x + d_x, t_y + d_y);\nresult += vec4(0.018736731, -0.0026039074, 0.050130025, -0.055364225);\ngl_FragColor = result;\n}\n"),_.set(this,"precision mediump float;\nvarying vec2 v_texture_position;\nuniform sampler2D u_texture;\nuniform vec2 u_size;\n\n#define go_0(x_off, y_off) (max(texture2D(u_texture, vec2(x_off, y_off)), 0.0))\n#define go_1(x_off, y_off) (max(-texture2D(u_texture, vec2(x_off, y_off)), 0.0))\nvoid main() {\nfloat t_x = v_texture_position.x;\nfloat t_y = v_texture_position.y;\nfloat d_x = 1.0 / u_size.x;\nfloat d_y = 1.0 / u_size.y;\n\nvec4 result = mat4(0.019100675, -0.014241565, 0.004667036, -0.03865062, 0.106731094, 0.026099661, 0.014594411, -0.011881356, 0.0040967264, -0.004626336, 0.006469508, 0.010875305, -0.033909045, -0.085905954, 0.07861378, 0.019452631) * go_0(t_x - d_x, t_y - d_y);\nresult += mat4(0.20777655, -0.060354974, 0.0023840065, -0.064121604, -0.17397617, 0.019293457, -0.09707183, 0.080641985, 0.01025124, -0.017382381, 0.008661793, -0.010995665, 0.21943407, -0.115574986, 0.14471593, -0.068836235) * go_0(t_x - d_x, t_y);\nresult += mat4(0.057942886, -0.06311754, 0.2253396, -0.04159292, -0.020731755, 0.007877151, 0.041525815, 0.025278691, 0.03041967, -0.025137542, 0.024364179, -0.024543528, 0.029438615, -0.015506873, 0.081686, -0.07812221) * go_0(t_x - d_x, t_y + d_y);\nresult += mat4(0.054237515, 0.0676094, -0.0047708177, 0.0043467237, -0.10032304, -0.020498628, 0.04240586, 0.07272254, 0.0784221, 0.017945962, -0.022310399, -0.013134622, 0.015638694, -0.10001543, 0.1043031, 0.05898838) * go_0(t_x, t_y - d_y);\nresult += mat4(-0.021652509, 0.35796642, 0.059497777, 0.23948468, 0.15454951, -0.10017235, -0.19072174, -0.44812536, -0.03974552, 0.04529369, 0.22207436, 0.026222564, -0.09705454, 0.5623026, -0.3354105, -0.017278556) * go_0(t_x, t_y);\nresult += mat4(-0.053682446, -0.03411237, -0.09399936, 0.15128824, -0.07463, -0.042020727, 0.0031783928, 0.13481957, -0.07731454, 0.044114403, -0.23085599, 0.060444202, -0.15015422, 0.0018040676, -0.18684982, 0.2812511) * go_0(t_x, t_y + d_y);\nresult += mat4(0.0029329916, 0.001596018, 0.0007512241, 0.016544111, -0.04876942, -0.05272409, 0.037884697, 0.049948208, 0.015518177, 0.11368592, -0.03815777, -0.013149978, -0.027638039, 0.107719295, -0.04115787, 0.02745414) * go_0(t_x + d_x, t_y - d_y);\nresult += mat4(0.016691081, 0.010204119, 0.04078854, 0.01613337, 0.03325829, 0.0114824055, -0.017286912, -0.07284126, -0.110984206, -0.21041764, 0.0089543555, 0.18986733, 0.01537506, -0.2059135, 0.029074017, 0.013117443) * go_0(t_x + d_x, t_y);\nresult += mat4(0.013965926, 0.029871881, 0.0034499036, -0.011343668, 0.022120327, -0.0068748263, 0.009324342, -0.039081004, 0.08032371, 0.050809264, 0.035050742, -0.2032847, 0.06305391, -0.021958945, 0.038569167, -0.22465245) * go_0(t_x + d_x, d_y + t_y);\nresult += mat4(0.046307724, -0.012419472, 0.007673863, -0.042344846, 0.011042414, 0.016994251, -0.018166406, -0.016955731, -0.13240299, 0.01768431, -0.027607648, 0.0699927, -0.02840628, 0.004414203, 0.0049618417, 0.011084679) * go_1(t_x - d_x, t_y - d_y);\nresult += mat4(-0.119954154, -0.007455482, -0.031108133, -0.009946449, 0.0077065965, 0.01660345, 0.032943666, 0.016376585, 0.10273124, 0.1556573, -0.24643841, 0.107307844, -0.068235755, 0.0561896, -0.0104672015, 0.042693343) * go_1(t_x - d_x, t_y);\nresult += mat4(-0.01634601, 0.04195375, -0.10401894, 0.047641944, -0.034602515, -0.0034419263, -0.010457858, 0.015194475, -0.03962551, -0.030031368, 0.16036317, 0.019283568, -0.05877721, 0.016504882, -0.15523468, 0.018161612) * go_1(t_x - d_x, t_y + d_y);\nresult += mat4(-0.08083991, 0.0024665035, -0.049373373, 0.030371357, 0.0113322195, -0.014676956, 0.011646689, -0.01142667, 0.124930486, 0.06625774, -0.045840867, -0.009693036, -0.012649251, -0.07388084, 0.008790075, 0.0013844534) * go_1(t_x, t_y - d_y);\nresult += mat4(-0.33941835, -0.2763476, -0.118311435, -0.063535266, 0.20936015, 0.13731301, 0.13443594, 0.07464433, 0.059650812, -0.36973104, 0.16444235, -0.37082872, 0.06432777, -0.18283032, -0.044489607, -0.13895285) * go_1(t_x, t_y);\nresult += mat4(0.13533665, 0.08268915, -0.03675727, -0.14348659, 0.0186255, -0.05051692, 0.056702953, 0.0061717895, 0.047663026, -0.088188455, 0.23254345, -0.014015464, 0.08400204, -0.0073777726, 0.2202068, -0.12366078) * go_1(t_x, t_y + d_y);\nresult += mat4(0.04361004, 0.046543695, 0.0064863074, -0.03358146, -0.022602187, 0.018138997, -0.011071864, 0.010244091, -0.019814799, -0.17250171, 0.040823266, -0.040131986, 0.010125854, 0.020660749, 0.0020435036, -0.010819304) * go_1(t_x + d_x, t_y - d_y);\nresult += mat4(-0.004810193, -0.11286074, 0.051985834, 0.04788631, -0.023950428, 0.036145125, -0.038203828, 0.052401308, 0.022986965, 0.26420745, -0.06076917, -0.09252999, 0.03164547, 0.15652153, -0.037934, -0.0035418556) * go_1(t_x + d_x, t_y);\nresult += mat4(0.03358366, -0.005219482, 0.007060882, -0.06569114, -0.02941682, 0.00966056, -0.0153679885, 0.019905418, -0.107232265, -0.03405676, -0.044340115, 0.26892832, -0.04723829, -0.02589829, 0.004563232, 0.19318114) * go_1(t_x + d_x, d_y + t_y);\nresult += vec4(-0.00346731, -0.0046263863, -0.004627155, -0.0057769152);\ngl_FragColor = result;\n}\n"),a.set(this,"precision mediump float;\nvarying vec2 v_texture_position;\nuniform sampler2D u_texture0;\nuniform sampler2D u_texture1;\nuniform vec2 u_size;\n\nvoid main() {\n\nvec2 tex_pt = vec2(1.0) / u_size;\n\nvec2 f0 = fract(v_texture_position * u_size);\nivec2 i0 = ivec2(f0 * vec2(2.0));\nint i = i0.y * 2 + i0.x;\nfloat c0;\nvec2 tex_pos = ((vec2(0.5) - f0) * tex_pt + v_texture_position);\nif (i == 0) {\n  c0 = texture2D(u_texture1, tex_pos)[0];\n} else if (i == 1) {\n  c0 = texture2D(u_texture1, tex_pos)[1];\n} else if (i == 2) {\n  c0 = texture2D(u_texture1, tex_pos)[2];\n} else {\n  c0 = texture2D(u_texture1, tex_pos)[3];\n}\ngl_FragColor = vec4(c0) + texture2D(u_texture0, v_texture_position);\n// gl_FragColor = texture2D(u_texture_orig, v_texture_position);\n// gl_FragColor = vec4(vec3(c0 * 10.0), 1.0);\n}\n");const c=new l.default(t,[this.inputTexture],u(this,o,"f"),u(this,n,"f"),this.inputWidth,this.inputHeight),x=new l.default(t,[c.outputTexture],u(this,o,"f"),u(this,r,"f"),this.inputWidth,this.inputHeight),f=new l.default(t,[x.outputTexture],u(this,o,"f"),u(this,i,"f"),this.inputWidth,this.inputHeight),m=new l.default(t,[f.outputTexture],u(this,o,"f"),u(this,_,"f"),this.inputWidth,this.inputHeight),y=new l.default(t,[this.inputTexture,m.outputTexture],u(this,o,"f"),u(this,a,"f"),this.outputWidth,this.outputHeight);this.outputTexture=y.outputTexture,this.programs=[c,x,f,m,y]}}e.default=x,o=new WeakMap,n=new WeakMap,r=new WeakMap,i=new WeakMap,_=new WeakMap,a=new WeakMap},9302:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BasePass=e.ImplementedPasses=void 0,e.ImplementedPasses=["Anime4kRestoreS","Anime4kUpscaleS"],e.BasePass=class{constructor(t,e,s,o,n){this.isLastPass=!1,this.gl=t,this.programs=[],this.scaleFactor=n,this.verticesBuffer=this.createBuffer(new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1])),this.inputWidth=s,this.inputHeight=o,this.outputWidth=s*n,this.outputHeight=o*n,this.inputTexture=e||this.createTexture(s,o),this.outputTexture=t.createTexture(),this.framebuffer=t.createFramebuffer()}render(){const t=this.gl,e=this.programs;let s;const o=e.length,n=o-1;for(t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.viewport(0,0,this.inputWidth,this.inputHeight),s=0;s<o;s++){const o=e[s];s===n?(t.viewport(0,0,this.outputWidth,this.outputHeight),this.isLastPass?t.bindFramebuffer(t.FRAMEBUFFER,null):t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,o.outputTexture,0)):o.outputTexture&&t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,o.outputTexture,0),t.useProgram(o.program),t.bindBuffer(t.ARRAY_BUFFER,this.verticesBuffer),t.enableVertexAttribArray(o.attributes.a_position),t.vertexAttribPointer(o.attributes.a_position,2,t.FLOAT,!1,0,0);for(let e=0,s=o.inputTextures.length;e<s;e++)t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,o.inputTextures[e]),t.uniform1i(o.uniforms["u_texture"+e],e);t.uniform2f(o.uniforms.u_size,this.inputWidth,this.inputHeight),t.drawArrays(t.TRIANGLES,0,6)}}createBuffer(t){const e=this.gl,s=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),s}createTexture(t,e){const s=this.gl,o=s.getParameter(s.TEXTURE_BINDING_2D),n=s.createTexture();return s.bindTexture(s.TEXTURE_2D,n),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.RGBA16F,t,e,0,s.RGBA,s.FLOAT,null),s.bindTexture(s.TEXTURE_2D,o),n}}},7496:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(t,e,o,n,r,i){const _=s.createProgram(t,o,n);this.program=_,this.inputTextures=e,this.outputTexture=s.createTexture(t,r,i),this.attributes={};const a=t.getProgramParameter(_,t.ACTIVE_ATTRIBUTES);for(let e=0;e<a;e++){const s=t.getActiveAttrib(_,e);this.attributes[s.name]=t.getAttribLocation(_,s.name)}this.uniforms={};const u=t.getProgramParameter(_,t.ACTIVE_UNIFORMS);for(let e=0;e<u;e++){const s=t.getActiveUniform(_,e);this.uniforms[s.name]=t.getUniformLocation(_,s.name)}}static createShader(t,e,s){const o=t.createShader(e);if(t.shaderSource(o,s),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(o));return o}static createProgram(t,e,o){const n=t.createProgram(),r=s.createShader(t,t.VERTEX_SHADER,e),i=s.createShader(t,t.FRAGMENT_SHADER,o);if(t.attachShader(n,r),t.attachShader(n,i),t.linkProgram(n),!t.getProgramParameter(n,t.LINK_STATUS))throw new Error(t.getProgramInfoLog(n));return n}static createTexture(t,e,s){const o=t.getParameter(t.TEXTURE_BINDING_2D),n=t.createTexture();return t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA16F,e,s,0,t.RGBA,t.FLOAT,null),t.bindTexture(t.TEXTURE_2D,o),n}}e.default=s},189:function(t,e,s){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.VideoProcessor=void 0;const n=o(s(3466));class r{constructor(t){var e,s;this.renderingId=0,this.isOn=!1,this.passes=[],this.videoResizeHandler=()=>{console.log(`Video was resized to ${this.videoElement.videoHeight}p`),this.initPasses(),this.isOn&&0!=this.videoElement.videoHeight?chrome.storage.local.get({showFpsWindow:!1},(t=>{this.fpsWindow&&(this.fpsWindow.dom.hidden=!t.showFpsWindow)})):this.fpsWindow&&(this.fpsWindow.dom.hidden=!0)},r.currentProcessorsMap.set(t,this),this.id=r.count++,this.videoElement=t,this.videoComputedStyle=window.getComputedStyle(t);const o=document.createElement("canvas");o.id="VideoProcessorCanvas"+this.id,o.width=t.videoWidth,o.height=t.videoHeight,null===(e=t.parentNode)||void 0===e||e.insertBefore(o,t),this.canvasElement=o,this.setCanvasVisibility(!1),this.adjustCanvasStyle();const i=this.canvasElement.getContext("webgl2",{depth:!1,stencil:!1,powerPreference:"high-performance"});i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0),i.getExtension("OES_texture_float_linear"),i.getExtension("EXT_color_buffer_float"),this.gl=i;const _=new n.default;_.dom.hidden=!0,_.dom.style.position="absolute",_.dom.style.zIndex="99999999",null===(s=o.parentNode)||void 0===s||s.insertBefore(_.dom,o),this.fpsWindow=_,chrome.storage.onChanged.addListener((t=>{Object.keys(t).includes("showFpsWindow")&&0!=this.videoElement.videoHeight&&this.isOn&&chrome.storage.local.get({showFpsWindow:!1},(()=>{this.fpsWindow.dom.hidden=!t.showFpsWindow.newValue}))})),this.passConstructors=r.currentPassConstractors,this.initPasses(),this.videoStyleObserver=new MutationObserver((()=>{this.adjustCanvasStyle()})),this.videoStyleObserver.observe(t,{attributeFilter:["style"]}),t.addEventListener("resize",this.videoResizeHandler)}static addVideoElement(t){if(this.currentProcessorsMap.has(t))console.log("The video element is already added.");else if(this.isOn&&!t.mediaKeys){const e=new r(t);e.start(),this.currentProcessorsMap.set(t,e)}else this.currentProcessorsMap.set(t,null)}static removeVideoElement(t){if(this.currentProcessorsMap.has(t)){const e=this.currentProcessorsMap.get(t);e&&e.close(),this.currentProcessorsMap.delete(t)}}static get hasDrmProtectedVideo(){for(const t of this.currentProcessorsMap.keys())if(t.mediaKeys)return!0;return!1}static setPassConstructors(t){this.currentPassConstractors=t;for(const e of this.currentProcessorsMap.values())e&&e.initPasses(t)}initPasses(t){const e=this.gl,s=this.videoElement;if(!e)return;t?this.passConstructors=t:t=this.passConstructors;const o=[];for(const n of t)if(0===o.length)o.push(new n(e,null,s.videoWidth,s.videoHeight));else{const t=o[o.length-1];o.push(new n(e,t.outputTexture,t.outputWidth,t.outputHeight))}o.length>=1&&(o[o.length-1].isLastPass=!0),this.passes=o,this.adjustCanvasSize()}adjustCanvasSize(){const t=this.canvasElement,e=this.passes;if(t){t.width=this.videoElement.videoWidth,t.height=this.videoElement.videoHeight;for(const s of e)t.width*=s.scaleFactor,t.height*=s.scaleFactor}}setCanvasVisibility(t){const e=this.videoElement,s=this.canvasElement;s&&(t?(e.style.display&&"none"!==e.style.display?(s.style.display=e.style.display,e.style.display="none"):"none"===s.style.display&&(s.style.display=""),s.hidden=!1,e.hidden=!0):("none"===e.style.display&&("none"!==s.style.display?e.style.display=s.style.display:e.style.display=""),s.style.display="none",e.hidden=!1,s.hidden=!0))}adjustCanvasStyle(){if(!this.canvasElement)return;const t=this.videoElement.style,e=this.canvasElement.style,s=this.videoComputedStyle;let o="";t.display&&"none"!==t.display?o=t.display:e.display&&"none"!==e.display&&(o=e.display),t.cssText&&(e.cssText=t.cssText),""===e.width&&(e.width="100%"),""===e.height&&(e.height="100%"),e.top=s.top,e.left=s.left,e.position=s.position,e.objectFit=s.objectFit,e.zIndex=s.zIndex,this.videoElement.hidden&&!this.canvasElement.hidden&&t.display&&(t.display="none",e.display=o)}render(t){if(this.isOn){const e=this.videoElement,s=this.gl,o=this.passes,n=this.fpsWindow;try{if(e&&s&&0!=e.videoHeight&&!e.mediaKeys){if(o.length>0){s.bindTexture(s.TEXTURE_2D,o[0].inputTexture),s.texImage2D(s.TEXTURE_2D,0,s.RGBA16F,s.RGBA,s.FLOAT,e);for(const t of o)t.render()}n&&n.update()}else e.mediaKeys&&(r.closeAll(),chrome.runtime.sendMessage({op:"drmProtectedVideoDetected"}))}catch(t){console.log("Suppressed render error:",t),this.stop()}this.renderingId===t&&e.requestVideoFrameCallback((()=>{this.render(t)}))}else this.stop()}start(){this.isOn=!0;const t=++this.renderingId;this.render(t),this.setCanvasVisibility(!0),0!=this.videoElement.videoHeight&&chrome.storage.local.get({showFpsWindow:!1},(t=>{this.fpsWindow&&(this.fpsWindow.dom.hidden=!t.showFpsWindow)}))}stop(){this.setCanvasVisibility(!1),this.fpsWindow&&(this.fpsWindow.dom.hidden=!0),this.isOn=!1}close(){var t;this.isOn=!1,this.setCanvasVisibility(!1),this.videoElement.removeEventListener("resize",this.videoResizeHandler),this.videoStyleObserver.disconnect(),this.gl&&(null===(t=this.gl.getExtension("WEBGL_lose_context"))||void 0===t||t.loseContext(),this.gl=null),this.canvasElement&&(this.canvasElement.remove(),this.canvasElement=null),this.fpsWindow&&(this.fpsWindow.dom.remove(),this.fpsWindow=null),r.currentProcessorsMap.delete(this.videoElement)}static startAll(){this.isOn=!0;for(let[t,e]of this.currentProcessorsMap){if(t.mediaKeys)return void this.closeAll();e||(e=new r(t),this.currentProcessorsMap.set(t,e)),e.start()}chrome.runtime.sendMessage({op:"changeIconToOn"})}static closeAll(){this.isOn=!1;for(let[t,e]of this.currentProcessorsMap.entries())e&&(e.close(),this.currentProcessorsMap.set(t,null));chrome.runtime.sendMessage({op:"changeIconToOff"})}}e.VideoProcessor=r,r.count=0,r.isOn=!1,r.currentPassConstractors=[],r.currentProcessorsMap=new Map}},e={};!function s(o){var n=e[o];if(void 0!==n)return n.exports;var r=e[o]={exports:{}};return t[o].call(r.exports,r,r.exports,s),r.exports}(8313)})();